var App={win:$(window),doc:$(document),is_mobile:detectmob(),ms_ie:/(MSIE|Trident\/|Edge\/)/i.test(navigator.userAgent),max_mobile_width:992,wheeling:!1};function detectmob(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))}function debounce(i,t,r){var n;return function(){var e=this,o=arguments,s=r&&!n;clearTimeout(n),n=setTimeout(function(){n=null,r||i.apply(e,o)},t),s&&i.apply(e,o)}}function fileBoxesInit(e){Array.prototype.forEach.call(e,function(e){var s=e.parentNode,i=s.innerHTML;e.addEventListener("change",function(e){var o="";(o=this.files&&1<this.files.length?(this.getAttribute("data-multiple-caption")||"").replace("{count}",this.files.length):e.target.value.split("\\").pop())?s.querySelector("span").innerHTML=o:s.innerHTML=i}),e.addEventListener("focus",function(){e.classList.add("has-focus")}),e.addEventListener("blur",function(){e.classList.remove("has-focus")})})}function check_scroll(){0==$(window).scrollTop()?$("body").addClass("scrollTop"):$(window).scrollTop()+$(window).height()==$(document).height()?$("body").addClass("scrollBottom"):$("body").removeClass("scrollTop scrollBottom")}App.Other=function(){App.is_mobile&&$("html").addClass("is_mobile"),App.doc.on("click",".block-accordion__link",function(){return $(this).parents(".block-accordion").removeClass("block-accordion-rolled").addClass("block-accordion-opened"),setTimeout(function(){$.fn.fullpage.reBuild(),console.log("reBuild")},2100),!1})},App.HeaderMenuMobile=function(){function e(){this.render()}var r;e.prototype={el:{sidr_selector:".sidr",h_menu_selector:".agroaudit-menu",mobile_btn_selector:".mobile-mainmenu-btn",sidr_class:"sidr-mobile-mainmenu"},render:function(){if(r=this,!$(r.el.mobile_btn_selector).length)return!1;r.sidrInit(),r.sidrSwipe(),r.sidrResize()},sidrInit:function(){void 0!==$.fn.sidr?$(r.el.mobile_btn_selector).sidr({name:r.el.sidr_class,source:r.el.h_menu_selector,side:"right"}):console.info("required jquery.sidr(.min).js (для мобильного меню)")},sidrClose:function(){$.sidr("close",r.el.sidr_class)},sidrSwipe:function(){void 0!==$.fn.swipe&&$(r.el.sidr_selector).swipe({excludedElements:"button, input, select, textarea, .noSwipe",swipeRight:function(e,o,s,i,t){r.sidrClose()}})},sidrResize:function(){var e=debounce(function(){App.win.width()>App.max_mobile_width&&r.sidrClose()},250);App.win.resize(e)}},new e},App.Sliders=function(){$(".services-carousel").slick({slidesToShow:3.6,infinite:!1,edgeFriction:0,responsive:[{breakpoint:1200,settings:{slidesToShow:3}},{breakpoint:768,settings:{slidesToShow:2}},{breakpoint:575,settings:{slidesToShow:1}}]}),$(".services-carousel").on("afterChange",function(e,o,s){o.$slides.length<=s+o.options.slidesToShow?($(".services-carousel").addClass("services-carousel--last"),$(".services-carousel").removeClass("services-carousel--first")):0==s?($(".services-carousel").addClass("services-carousel--first"),$(".services-carousel").removeClass("services-carousel--last")):($(".services-carousel").removeClass("services-carousel--last"),$(".services-carousel").removeClass("services-carousel--first"))}),$(".services-carousel").on("setPosition",function(e,o,s){o.$slides.css("height",o.$slideTrack.height()+"px")}),$(".technology-slider").slick({slidesToShow:1,infinite:!1,edgeFriction:0,arrows:!1}),App.doc.on("click",".tab-link",function(){return $(this).siblings("a").removeClass("active"),$(this).addClass("active"),$($(this).data("slider")).slick("slickGoTo",$(this).data("slide")),!1})},App.FullPage=function(){var e=!1,o=!1,s=[],i=[];$("#menu li").each(function(e){s.push($(this).data("menuanchor")),i.push($(this).text())}),App.is_mobile&&(o=e=!1),$("#agroaudit-fullpage").fullpage({autoScrolling:e,scrollOverflow:o,anchors:s,menu:"#menu",navigationPosition:"right",navigationTooltips:i,navigation:!0,afterRender:function(){App.RemoveMainPreloader()}}),App.doc.on("click",".arrow-link-index",function(){return $("#agroaudit-fullpage").fullpage.moveTo(2),!1}),App.doc.on("click",".arrow-link-last",function(){return $("#agroaudit-fullpage").fullpage.moveTo(1),!1})},App.RemoveMainPreloader=function(){$(".preloader").fadeOut("slow")},$.validator.addMethod("lettersonly",function(e,o){return this.optional(o)||/^[\u0400-\u04FF\s]*$/i.test(jQuery.trim(e))},"Только символы кириллицы и пробелы"),App.Forms=function(){function e(){this.render()}var t;e.prototype={el:{application_form_selector:".application_form",form_response_selector:".form-response",form_submit_selector:":submit"},render:function(){(t=this).applicationForm()},applicationForm:function(){var i=$(t.el.application_form_selector).find(t.el.form_submit_selector).text(),o={name:{required:"Представьтесь пожалуйста",maxlength:"Не больше 200 символов"},email:{required:"Укажите ваш электронный адрес",email:"Введите корректный адрес типа text@text.text"},phone:{required:"Укажите ваш телефон",maxlength:"Не больше 50 символов"}};$(t.el.application_form_selector).each(function(e){$(this).submit(function(e){$(this).find(t.el.form_response_selector).removeClass("color-green color-red").html("&nbsp;").slideUp("fast"),e.preventDefault()}),$(this).validate({rules:{name:{required:!0,maxlength:200},email:{required:!0,email:!0},phone:{required:!0,maxlength:50}},messages:o,focusInvalid:!1,invalidHandler:function(e,o){},showErrors:function(e,o){console.log(o),0<o.length?$(t.el.application_form_selector).find(t.el.form_submit_selector).prop("disabled",!0):$(t.el.application_form_selector).find(t.el.form_submit_selector).prop("disabled",!1),this.defaultShowErrors(),$(t.el.application_form_selector).find("label.error:visible").length&&$("body,html").animate({scrollTop:$("label.error:visible").offset().top-100},800)},submitHandler:function(o){if(0==grecaptcha.getResponse().length)return alert("Подтвердите, что вы не робот."),!1;var s=new FormData,e=$(o).serializeArray();$.each(e,function(e,o){s.append(o.name,o.value)}),$(o).find(t.el.form_submit_selector).prop("disabled",!0).text("Отправка..."),$.ajax({url:$(o).attr("action"),type:"POST",dataType:"json",cache:!1,data:s,mimeType:"multipart/form-data",processData:!1,contentType:!1,success:function(e){e.success?$(o).find(t.el.form_response_selector).html("Спасибо! Мы свяжемся с Вами.").addClass("color-green"):$(o).find(t.el.form_response_selector).html("Ошибка отправки письма <br> "+e.ErrorInfo).addClass("color-red")},error:function(e){console.log(e),e.hasOwnProperty("responseJSON")?($(o).find(t.el.form_response_selector).html(e.responseJSON.message).addClass("color-red"),console.log("error: "+e.responseJSON.message)):($(o).find(t.el.form_response_selector).html("Ошибка status "+e.status+", statusText "+e.statusText).addClass("color-red"),console.log("data.responseText"),console.log(e.responseText))},complete:function(){$(o).find(t.el.form_response_selector).slideDown("fast"),$(o).find(t.el.form_submit_selector).prop("disabled",!1).text(i),$(t.el.form_response_selector).is(":visible")&&$("body,html").animate({scrollTop:$(t.el.form_response_selector).offset().top-100},800)}})}})})}},new e},$(document).ready(function(){(new WOW).init(),App.Other(),App.HeaderMenuMobile(),App.Sliders(),App.FullPage(),App.Forms()});