var App={win:$(window),doc:$(document),is_mobile:detectmob(),ms_ie:/(MSIE|Trident\/|Edge\/)/i.test(navigator.userAgent),header_height:0,middle_height:0,max_mobile_width:768};function detectmob(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))}function debounce(r,n,o){var s;return function(){var e=this,i=arguments,t=o&&!s;clearTimeout(s),s=setTimeout(function(){s=null,o||r.apply(e,i)},n),t&&r.apply(e,i)}}App.HeaderMenuDesktop=function(){void 0!==$.fn.superfish?$(".header-menu > ul.sf-menu").superfish():console.info("required superfish(.min).js")},App.HeaderMenuMobile=function(){function e(){this.render()}var o;e.prototype={el:{sidr_selector:".sidr",h_menu_selector:".header-menu",mobile_btn_selector:".mobile-mainmenu-btn",sidr_class:"sidr-mobile-mainmenu"},render:function(){if(o=this,!$(o.el.mobile_btn_selector).length)return!1;o.sidrInit(),o.sidrSwipe(),o.sidrResize()},sidrInit:function(){void 0!==$.fn.sidr?$(o.el.mobile_btn_selector).sidr({name:o.el.sidr_class,source:o.el.h_menu_selector,side:"right"}):console.info("required jquery.sidr(.min).js (для мобильного меню)")},sidrClose:function(){$.sidr("close",o.el.sidr_class)},sidrSwipe:function(){void 0!==$.fn.swipe&&$(o.el.sidr_selector).swipe({excludedElements:"button, input, select, textarea, .noSwipe",swipeRight:function(e,i,t,r,n){o.sidrClose()}})},sidrResize:function(){var e=debounce(function(){App.win.width()>App.max_mobile_width&&o.sidrClose()},250);App.win.resize(e)}},new e},App.PhotoWaterwheelSlider=function(){var e=!0;$(".waterwheel-carousel .waterwheel-slide").length<4&&(e=!1,$(".waterwheel-carousel").addClass("slick-without-arrows")),$(".waterwheel-carousel").slick({lazyLoad:"ondemand",centerMode:e,centerPadding:"20px",focusOnSelect:!0,infinite:!0,slidesToShow:3,responsive:[{breakpoint:768,settings:{centerMode:!1,centerPadding:"0px",slidesToShow:1}}]}),$(".lightbox-link").magnificPopup({type:"image",tLoading:"Загрузка фото #%curr%...",mainClass:"mfp-no-margins mfp-with-zoom",closeBtnInside:!0,fixedContentPos:!1,gallery:{enabled:!0,navigateByImgClick:!0,tCounter:""},image:{tError:'<a href="%url%">Изображение #%curr%</a> не может быть загружено.',titleSrc:function(e){return null!=e.el.attr("title")&&""!=e.el.attr("title")?e.el.attr("title"):""}},zoom:{enabled:!0,duration:300}})},App.ReviewSlider=function(){$(".review-carousel").slick({infinite:!1,slidesToShow:1,adaptiveHeight:!0})},$.validator.addMethod("lettersonly",function(e,i){return this.optional(i)||/^[\u0400-\u04FF\s]*$/i.test(jQuery.trim(e))},"Только символы кириллицы и пробелы"),App.Forms=function(){function e(){this.render()}var t;e.prototype={el:{application_form_selector:".application_form",form_response_selector:".form-response",form_submit_selector:":submit"},render:function(){(t=this).popupForm(),t.applicationForm()},popupForm:function(){$(".js-popup-with-form").magnificPopup({type:"inline",preloader:!1,focus:"#name",tClose:"Закрыть",fixedContentPos:!0,fixedBgPos:!0,removalDelay:300,mainClass:"my-mfp-zoom-in",callbacks:{beforeOpen:function(){$(window).width()<992?this.st.focus=!1:this.st.focus="#name"}}})},applicationForm:function(){$(t.el.application_form_selector).each(function(e){$(this).submit(function(e){$(this).find(t.el.form_response_selector).removeClass("color-green color-red").html("&nbsp;").css("visibility","hidden").slideUp("fast"),e.preventDefault()}),$(this).validate({rules:{name:{required:!0,maxlength:200,lettersonly:!0},email:{required:!0,email:!0},msg:{required:!0,maxlength:2e3},agreement:{required:!0}},messages:{name:{required:"Представьтесь пожалуйста",maxlength:"Не больше 200 символов"},email:{required:"Укажите ваш электронный адрес",email:"Введите корректный адрес типа text@text.text"},msg:{required:"Сообщение должно быть непустым",maxlength:"Не больше 2000 символов"},agreement:{required:"Необходимо дать согласие"}},focusInvalid:!1,invalidHandler:function(e,i){i.numberOfInvalids()},submitHandler:function(i){$(i).find(t.el.form_submit_selector).prop("disabled",!0).text("Отправка..."),$.ajax({url:$(i).attr("action"),type:"POST",dataType:"json",cache:!1,data:$(i).serialize(),success:function(e){e.success?$(i).find(t.el.form_response_selector).html("Спасибо! Мы свяжемся с Вами.").addClass("color-green"):$(i).find(t.el.form_response_selector).html("Ошибка отправки письма <br> "+e.ErrorInfo).addClass("color-red")},error:function(e){e.hasOwnProperty("responseJSON")?($(i).find(t.el.form_response_selector).html(e.responseJSON.message).addClass("color-red"),console.log("error: "+e.responseJSON.message)):$(i).find(t.el.form_response_selector).html(e.status+" "+e.statusText+" Ошибка соединения").addClass("color-red")},complete:function(){$(i).find(t.el.form_response_selector).slideDown("fast").css("visibility","visible"),$(i).find(t.el.form_submit_selector).prop("disabled",!1).text("Отправить")}})}})})}},new e},$(document).ready(function(){App.HeaderMenuDesktop(),App.HeaderMenuMobile(),App.PhotoWaterwheelSlider(),App.ReviewSlider(),App.Forms()});